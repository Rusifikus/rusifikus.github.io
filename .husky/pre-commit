#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

origin=$PWD


echo 'ğŸ—ï¸ğŸ’» Running Prettier, ESLing and TSConfig checks and building your project before committing'

for dir in $(ls -d */ | grep -v 'node_modules'); do

    if [ -d "node_modules" ] 
    then
        # Fixing auto-fixable prettier problems
        echo 'ğŸš§ Fixing auto-fixable prettier problems';
        npm run format


        echo 'ğŸ“ƒ Running prettier check';
        # Running Prettier Check    
        npm run check-format ||
        (
            echo 'âŒ Prettier Check Failed. Run npm run format, add changes and try commit again.';
            false;
        )   

        echo 'âœ… Prettier Check Passed.';


        echo 'ğŸ“ƒ Running eslint check';
        # Running ESLint Check
        npm run check-lint ||
        (
            echo 'âŒ ESLint Check Failed. Make the required changes listed above, add changes and try to commit again.'
            false; 
        )

        echo 'âœ… ESLint Check Passed.';
            

    fi
done

# Everything is successful
echo 'âœ…âœ…âœ…âœ… Every Check Passed âœ…âœ…âœ…âœ…'